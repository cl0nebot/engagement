{"version":3,"sources":["webpack:///engage.min.js","webpack:///webpack/bootstrap cbce4fdc5f1a1cea70f7?25bf","webpack:///./src/index.js?9552","webpack:///./src/base/index.js?d841","webpack:///./src/base/engage.js?dd44","webpack:///./src/metrics/index.js?27ae","webpack:///./src/metrics/Manager.js?6c59","webpack:///./src/tracking/index.js?f9c1","webpack:///./src/tracking/Scroll.js?cb42","webpack:///./src/utils/index.js?d310","webpack:///./src/utils/Utils.js?24b5","webpack:///./src/utils/Adapters.js?aa00","webpack:///./src/utils/PubSub.js?5709","webpack:///./src/tracking/Visibility.js?9933","webpack:///./src/tracking/Session.js?16c7"],"names":["engage","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_base","_base2","window","_engage","_engage2","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_metrics","_utils","defaults","content","url","options","this","$$","extend","manager","Manager","emitter","value","data","api_key","inspect","JSON","stringify","Blob","toJSON","type","_this","setInterval","navigator","sendBeacon","format","Error","element","get","set","val","_Manager","_Manager2","_tracking","timestamp","Date","now","pubsub","PubSub","scroll","Scroll","session","Session","visibility","Visibility","startTracking","addEventListener","publish","document","Adapters","vchange","session_id","referrer","x_pos","xPos","y_pos","yPos","top","bottom","word_count","is_visible","source_url","in_viewport","elementInViewport","_Scroll","_Scroll2","_Visibility","_Visibility2","_Session","_Session2","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","viewportChecks","setScrollCalc","setContentElements","update","subscribe","pageYOffset","scrollCalc","pageXOffset","documentElement","scrollTop","scrollLeft","body","self","elements","getElementsByClassName","keys","forEach","innerHTML","replace","split","getBoundingClientRect","el","rect","right","left","innerWidth","clientWidth","innerHeight","clientHeight","_scrollCalc","_scrollCalc2","elementsInViewport","some","inBounds","_Utils","_Utils2","_Adapters","_Adapters2","_PubSub","_PubSub2","obj1","obj2","assign","create","vhidden","hidden","mozHidden","msHidden","webkitHidden","handlers","event","handler","context","ctx","bind","sessionId","URL","sessionStorage","getItem","newId","idTemplate","setItem","match","location","hostname","Math","random","toString","substr"],"mappings":"AAAA,GAAIA,QACK,SAAUC,GCGnB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,GAGAV,EAAA,KDOM,SAASI,EAAQD,EAASH,GAE/B,YAMA,SAASW,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GErDxF,GAAAG,GAAAf,EAAA,GFmDKgB,EAASL,EAAuBI,EEjDrCE,QAAOnB,OAAPkB,aACAZ,EAAOD,QAAPa,cFyDM,SAASZ,EAAQD,EAASH,GAE/B,YAMA,SAASW,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GGpExF,GAAAM,GAAAlB,EAAA,GHkEKmB,EAAWR,EAAuBO,EGhEvCd,GAAOD,QAAPgB,cHwEM,SAASf,EAAQD,EAASH,GAE/B,YAQA,SAASoB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhH,GAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,MI9EjiBkB,EAAAxC,EAAA,GACAyC,EAAAzC,EAAA,GAEIqB,EAAW,KACTqB,GACJC,QAAS,iDACTC,IAAK,oCAGD9C,EJmFQ,WIjFZ,QAAAA,GAAY+C,GAASzB,EAAA0B,KAAAhD,GACduB,IAAYA,EAAWyB,MAC5BA,KAAKD,QAAUJ,EAAAM,GAAGC,OAAON,EAAUG,GACnCC,KAAKG,QAAU,GAAAT,GAAAU,QAAYL,GAC3BC,KAAKK,UJ0IN,MAjDA3B,GAAa1B,IACXsC,IAAK,SACLgB,MAAO,WIvFR,GAAMC,GAAOZ,EAAAM,GAAGC,QAASM,QAASR,KAAKD,QAAQS,SAAWR,KAAKG,QAAQM,UACvE,OAAOC,MAAKC,WAAYJ,YJ2FvBjB,IAAK,SACLgB,MAAO,WIxFR,MAAO,IAAIM,OACRZ,KAAKa,WAAaC,KAAMd,KAAKD,QAAQF,aJ2FvCP,IAAK,UACLgB,MAAO,WIxFA,GAAAS,GAAAf,IACRgB,aAAY,WACV7C,OAAO8C,UAAUC,WAAWH,EAAKhB,QAAQD,IAAKiB,EAAKI,WAClD,UJ6FF7B,IAAK,MACLgB,MAAO,SIlFCP,GACT,IAAKA,EAAW,KAAM,IAAIqB,OAAM,oBAChC,KAAKrB,EAAQS,QAAW,KAAM,IAAIY,OAAM,oBACxC,KAAKrB,EAAQsB,QAAW,KAAM,IAAID,OAAM,2BACxC,OAAO,IAAIpE,GAAO+C,MJ2FjBT,IAAK,WACLgC,IAAK,WIxGN,IAAK/C,EAAY,KAAM,IAAI6C,OAAM,wBACjC,OAAO7C,IJ6GNgD,IAAK,SI1GYC,GACdjD,IAAYA,EAAWiD,OJgHrBxE,IIrGVM,GAAOD,QAAUL,GJ4GX,SAASM,EAAQD,EAASH,GAE/B,YAMA,SAASW,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GKxKxF,GAAA2D,GAAAvE,EAAA,GLsKKwE,EAAY7D,EAAuB4D,EKpKxCnE,GAAOD,SAAY+C,QAAAsB,eL4Kb,SAASpE,EAAQD,EAASH,GAE/B,YAQA,SAASoB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhH,GAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,MMlLjiBmD,EAAAzE,EAAA,GACAyC,EAAAzC,EAAA,GAEMkD,ENuLS,WMrLb,QAAAA,GAAYL,GAASzB,EAAA0B,KAAAI,GACnBJ,KAAKD,QAAUA,EACfC,KAAK4B,UAAYC,KAAKC,MACtB9B,KAAK+B,OAAS,GAAApC,GAAAqC,OACdhC,KAAKiC,OAAS,GAAAN,GAAAO,OAAWnC,EAAQsB,SACjCrB,KAAKmC,QAAU,GAAAR,GAAAS,QACfpC,KAAKqC,WAAa,GAAAV,GAAAW,WAClBtC,KAAKuC,gBN0NN,MA/BA7D,GAAa0B,IACXd,IAAK,gBACLgB,MAAO,WM1LM,GAAAS,GAAAf,IACd7B,QAAOqE,iBAAiB,SAAU,iBAAMzB,GAAKgB,OAAOU,QAAQ,YAC5DC,SAASF,iBAAiB7C,EAAAgD,SAASC,QAAS,iBAAM7B,GAAKgB,OAAOU,QAAQ,gBAAe,MNmMpFnD,IAAK,UACLgB,MAAO,WMhMR,OACEsB,UAAW5B,KAAK4B,UAChBiB,WAAY7C,KAAKmC,QAAQU,WACzBC,SAAU9C,KAAKmC,QAAQW,SACvBC,MAAO/C,KAAKiC,OAAOe,KACnBC,MAAOjD,KAAKiC,OAAOiB,KACnBC,IAAKnD,KAAKiC,OAAOkB,IACjBC,OAAQpD,KAAKiC,OAAOmB,OACpBC,WAAYrD,KAAKiC,OAAOoB,WACxBC,WAAYtD,KAAKqC,WAAWiB,WAC5BC,WAAYvD,KAAKmC,QAAQoB,WACzBC,YAAaxD,KAAKiC,OAAOwB,uBNsMrBrD,IMhMV9C,GAAOD,QAAU+C,GNuMX,SAAS9C,EAAQD,EAASH,GAE/B,YAcA,SAASW,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GO7PxF,GAAA4F,GAAAxG,EAAA,GPmPKyG,EAAW9F,EAAuB6F,GOlPvCE,EAAA1G,EAAA,IPsPK2G,EAAehG,EAAuB+F,GOrP3CE,EAAA5G,EAAA,IPyPK6G,EAAYlG,EAAuBiG,EOvPxCxG,GAAOD,SAAY6E,OAAAyB,aAAQrB,WAAAuB,aAAYzB,QAAA2B,eP+PjC,SAASzG,EAAQD,EAASH,GAE/B,YAQA,SAASoB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhH,GAAIuF,GAAiB,WAAc,QAASC,GAAcC,EAAKpF,GAAK,GAAIqF,MAAeC,GAAK,EAAUC,GAAK,EAAWC,EAAKC,MAAW,KAAM,IAAK,GAAiCC,GAA7BC,EAAKP,EAAIQ,OAAOC,cAAmBP,GAAMI,EAAKC,EAAGG,QAAQC,QAAoBV,EAAKW,KAAKN,EAAGlE,QAAYxB,GAAKqF,EAAKpF,SAAWD,GAA3DsF,GAAK,IAAoE,MAAOW,GAAOV,GAAK,EAAMC,EAAKS,EAAO,QAAU,KAAWX,GAAMK,EAAG,WAAWA,EAAG,YAAe,QAAU,GAAIJ,EAAI,KAAMC,IAAQ,MAAOH,GAAQ,MAAO,UAAUD,EAAKpF,GAAK,GAAIkG,MAAMC,QAAQf,GAAQ,MAAOA,EAAY,IAAIQ,OAAOC,WAAYvF,QAAO8E,GAAQ,MAAOD,GAAcC,EAAKpF,EAAa,MAAM,IAAIL,WAAU,4DAEllBC,EAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,MQzQjiBmB,EAAAzC,EAAA,GAEMgF,ER6QQ,WQ3QZ,QAAAA,GAAYb,GAAS/C,EAAA0B,KAAAkC,GACnBlC,KAAKqD,WAAa,EAClBrD,KAAKkF,kBACLlF,KAAKmF,gBACLnF,KAAKoF,mBAAmB/D,GACxBrB,KAAKqF,SACLrF,KAAK+B,OAAS,GAAApC,GAAAqC,OACdhC,KAAK+B,OAAOuD,UAAU,SAAUtF,KAAKqF,OAAQrF,MRiV9C,MAhEAtB,GAAawD,IACX5C,IAAK,gBACLgB,MAAO,WQ/QR,GAAkC,mBAAvBnC,QAAOoH,YAChBvF,KAAKwF,WAAa,kBACdrH,OAAOsH,YAAatH,OAAOoH,kBAC1B,IAAkD,mBAAvC7C,UAASgD,gBAAgBC,WAC3CjD,SAASgD,gBAAgBC,UAAY,EACnC3F,KAAKwF,WAAa,kBACd9C,SAASgD,gBAAgBE,WAAYlD,SAASgD,gBAAgBC,gBAC7D,IAAuC,mBAA5BjD,UAASmD,KAAKF,UAI9B,KAAM,IAAIvE,OAAM,gBAHhBpB,MAAKwF,WAAa,kBACd9C,SAASmD,KAAKD,WAAYlD,SAASmD,KAAKF,gBRwR7CrG,IAAK,qBACLgB,MAAO,SQnRSe,GACjB,GAAMyE,GAAO9F,KACP+F,EAAWrD,SAASsD,uBAAuB3E,EACjD,IAAwB,IAApB0E,EAAShH,OACX,KAAM,IAAIqC,OAAM,oBAEhBhC,QAAO6G,KAAKF,GAAUG,QAAQ,SAAC5G,GAC7BwG,EAAKzC,YAAc0C,EAASzG,GAAK6G,UAAUC,QAAQ,kBAAmB,IAAIC,MAAM,KAAKtH,OACrF+G,EAAKZ,eAAeJ,KAAKiB,EAASzG,MAEpCwG,EAAK3C,IAAM4C,EAAS,GAAGO,wBAAwBnD,IAC/C2C,EAAK1C,OAAS2C,EAASA,EAAShH,OAAS,GAAGuH,wBAAwBlD,URuRrE9D,IAAK,WACLgB,MAAO,SQpRDiG,GACP,GAAMC,GAAOD,EAAGD,uBAChB,OAAOE,GAAKpD,OAAS,GACnBoD,EAAKC,MAAQ,GACbD,EAAKE,MAAQvI,OAAOwI,YAAcjE,SAASgD,gBAAgBkB,cAC3DJ,EAAKrD,KAAOhF,OAAO0I,aAAenE,SAASgD,gBAAgBoB,iBRoR5DxH,IAAK,SACLgB,MAAO,WQlRD,GAAAyG,GACkB/G,KAAKwF,aADvBwB,EAAAhD,EAAA+C,EAAA,EACN/G,MAAKgD,KADCgE,EAAA,GACKhH,KAAKkD,KADV8D,EAAA,GAEPhH,KAAKyD,kBAAoBzD,KAAKiH,wBR2R7B3H,IAAK,qBACLgB,MAAO,WQzRW,GAAAS,GAAAf,IACnB,OAAOA,MAAKkF,eAAegC,KAAK,SAAAX,GAAA,MAAMxF,GAAKoG,SAASZ,SRiS9CrE,IQ7RV5E,GAAOD,QAAU6E,GRoSX,SAAS5E,EAAQD,EAASH,GAE/B,YAcA,SAASW,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GSnXxF,GAAAsJ,GAAAlK,EAAA,GTyWKmK,EAAUxJ,EAAuBuJ,GSxWtCE,EAAApK,EAAA,GT4WKqK,EAAa1J,EAAuByJ,GS3WzCE,EAAAtK,EAAA,IT+WKuK,EAAW5J,EAAuB2J,ES7WvClK,GAAOD,SAAY4C,GAAAoH,aAAI1E,SAAA4E,aAAUvF,OAAAyF,eTqX3B,SAASnK,EAAQD,GAEtB,YAIA,SAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhH,GAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,MU7X3hByB,EViYI,WACP,QAASA,KACP3B,EAAgB0B,KAAMC,GAUxB,MAPAvB,GAAauB,EAAI,OACfX,IAAK,SACLgB,MAAO,SUtYIoH,EAAMC,GAClB,MAAOvI,QAAOwI,OAAOxI,OAAOyI,OAAOzI,OAAOK,WAAYiI,EAAMC,OV0YtD1H,IUrYV3C,GAAOD,QAAU4C,GV4YX,SAAS3C,EAAQD,GAEtB,YWtZD,IAAIyK,GAAA,OACAlF,EAAA,MAE2B,oBAApBF,UAASqF,QAClBD,EAAU,SACVlF,EAAU,oBAC6B,mBAAvBF,UAASsF,WACzBF,EAAU,YACVlF,EAAU,uBAC4B,mBAAtBF,UAASuF,UACzBH,EAAU,WACVlF,EAAU,sBACgC,mBAA1BF,UAASwF,eACzBJ,EAAU,eACVlF,EAAU,0BAGZtF,EAAOD,SAAYyK,UAASlF,YX6ZtB,SAAStF,EAAQD,GAEtB,YAIA,SAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhH,GAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,MYlb3hB2J,KAEAnG,EZsbQ,WYpbZ,QAAAA,KAAc1D,EAAA0B,KAAAgC,GACZhC,KAAKmI,SAAWA,EZ4cjB,MAlBAzJ,GAAasD,IACX1C,IAAK,YACLgB,MAAO,SYzbA8H,EAAOC,EAASC,GACxB,GAAMC,GAA0B,mBAAZD,GAA2BD,EAAUC,CACzDtI,MAAKmI,SAASrD,MAAOsD,QAAOC,QAASA,EAAQG,KAAKD,QZ4bjDjJ,IAAK,UACLgB,MAAO,SY1bF8H,GACN,GAAItJ,GAAA,MACJ,KAAKA,EAAI,EAAGA,EAAIkB,KAAKmI,SAASpJ,OAAQD,IAChCkB,KAAKmI,SAASrJ,GAAGsJ,QAAUA,GAC7BpI,KAAKmI,SAASrJ,GAAGuJ,QAAQ5K,WZgcvBuE,IY1bV1E,GAAOD,QAAU2E,GZicX,SAAS1E,EAAQD,EAASH,GAE/B,YAMA,SAASoB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhH,GAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,Ma5djiBmB,EAAAzC,EAAA,GAEMoF,EbgeY,Wa9dhB,QAAAA,KAAchE,EAAA0B,KAAAsC,GACZtC,KAAKsD,YAAa,EAClBtD,KAAK+B,OAAS,GAAApC,GAAAqC,OACdhC,KAAK+B,OAAOuD,UAAU,aAActF,KAAKqF,OAAQrF,Mb2elD,MAPAtB,GAAa4D,IACXhD,IAAK,SACLgB,MAAO,WaleRN,KAAKsD,WAAanF,OAAOuE,SAAS/C,EAAAgD,SAASmF,abuerCxF,IaleVhF,GAAOD,QAAUiF,GbyeX,SAAShF,EAAQD,GAEtB,YAIA,SAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhH,GAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,Mc7f3hB4D,EdigBS,Wc/fb,QAAAA,KAAc9D,EAAA0B,KAAAoC,GACZpC,KAAK6C,WAAa7C,KAAKyI,YACvBzI,KAAK8C,SAAW9C,KAAK8C,WACrB9C,KAAKuD,WAAab,SAASgG,IAAItC,QAAQ,MAAO,Id6hB/C,MAxBA1H,GAAa0D,IACX9C,IAAK,YACLgB,MAAO,QAASmI,KcngBjB,GAAMA,GAAYtK,OAAOwK,eAAeC,QAAQ,mBAChD,IAAiB,MAAbH,EAAmB,CACrB,GAAMI,GAAQ7I,KAAK8I,YAEnB,OADA3K,QAAOwK,eAAeI,QAAQ,mBAAoBF,GAC3CA,EAET,MAAOJ,MdugBNnJ,IAAK,WACLgB,MAAO,WcpgBR,GAAMR,GAAM4C,SAASI,SAASsD,QAAQ,MAAO,GAC7C,OAAOtG,GAAIkJ,MAAMC,SAASC,UAAYpJ,EAAM,MdwgB3CR,IAAK,aACLgB,MAAO,WcrgBR,UAAW6I,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,GAAhD,IAAsDzH,KAAKC,Ud0gBrDM,IcrgBV9E,GAAOD,QAAU+E","file":"engage.min.js","sourcesContent":["var engage =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\twindow.engage = _base2.default;\n\tmodule.exports = _base2.default;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _engage = __webpack_require__(2);\n\t\n\tvar _engage2 = _interopRequireDefault(_engage);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tmodule.exports = _engage2.default;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _metrics = __webpack_require__(3);\n\t\n\tvar _utils = __webpack_require__(7);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar instance = null;\n\tvar defaults = {\n\t  content: 'application/vnd.engage.api+json; charset=UTF-8',\n\t  url: 'http://api.engage.dev/v1/metrics'\n\t};\n\t\n\tvar engage = function () {\n\t  function engage(options) {\n\t    _classCallCheck(this, engage);\n\t\n\t    if (!instance) {\n\t      instance = this;\n\t    }\n\t    this.options = _utils.$$.extend(defaults, options);\n\t    this.manager = new _metrics.Manager(options);\n\t    this.emitter();\n\t  }\n\t\n\t  _createClass(engage, [{\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      var data = _utils.$$.extend({ api_key: this.options.api_key }, this.manager.inspect());\n\t      return JSON.stringify({ data: data });\n\t    }\n\t  }, {\n\t    key: 'format',\n\t    value: function format() {\n\t      return new Blob([this.toJSON()], { type: this.options.content });\n\t    }\n\t  }, {\n\t    key: 'emitter',\n\t    value: function emitter() {\n\t      var _this = this;\n\t\n\t      setInterval(function () {\n\t        window.navigator.sendBeacon(_this.options.url, _this.format());\n\t      }, 2000);\n\t    }\n\t  }], [{\n\t    key: 'run',\n\t    value: function run(options) {\n\t      if (!options) {\n\t        throw new Error('No options passed');\n\t      }\n\t      if (!options.api_key) {\n\t        throw new Error('No API Key passed');\n\t      }\n\t      if (!options.element) {\n\t        throw new Error('No element option passed');\n\t      }\n\t      return new engage(options); // eslint-disable-line new-cap\n\t    }\n\t  }, {\n\t    key: 'instance',\n\t    get: function get() {\n\t      if (!instance) {\n\t        throw new Error('Engage is not running');\n\t      }\n\t      return instance;\n\t    },\n\t    set: function set(val) {\n\t      if (instance) {\n\t        instance = val;\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return engage;\n\t}();\n\t\n\tmodule.exports = engage;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _Manager = __webpack_require__(4);\n\t\n\tvar _Manager2 = _interopRequireDefault(_Manager);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tmodule.exports = { Manager: _Manager2.default };\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _tracking = __webpack_require__(5);\n\t\n\tvar _utils = __webpack_require__(7);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Manager = function () {\n\t  function Manager(options) {\n\t    _classCallCheck(this, Manager);\n\t\n\t    this.options = options;\n\t    this.timestamp = Date.now();\n\t    this.pubsub = new _utils.PubSub();\n\t    this.scroll = new _tracking.Scroll(options.element);\n\t    this.session = new _tracking.Session();\n\t    this.visibility = new _tracking.Visibility();\n\t    this.startTracking();\n\t  }\n\t\n\t  _createClass(Manager, [{\n\t    key: 'startTracking',\n\t    value: function startTracking() {\n\t      var _this = this;\n\t\n\t      window.addEventListener('scroll', function () {\n\t        return _this.pubsub.publish('Scroll');\n\t      });\n\t      document.addEventListener(_utils.Adapters.vchange, function () {\n\t        return _this.pubsub.publish('Visibility');\n\t      }, false);\n\t    }\n\t  }, {\n\t    key: 'inspect',\n\t    value: function inspect() {\n\t      return {\n\t        timestamp: this.timestamp,\n\t        session_id: this.session.session_id,\n\t        referrer: this.session.referrer,\n\t        x_pos: this.scroll.xPos,\n\t        y_pos: this.scroll.yPos,\n\t        top: this.scroll.top,\n\t        bottom: this.scroll.bottom,\n\t        word_count: this.scroll.word_count,\n\t        is_visible: this.visibility.is_visible,\n\t        source_url: this.session.source_url,\n\t        in_viewport: this.scroll.elementInViewport\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return Manager;\n\t}();\n\t\n\tmodule.exports = Manager;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _Scroll = __webpack_require__(6);\n\t\n\tvar _Scroll2 = _interopRequireDefault(_Scroll);\n\t\n\tvar _Visibility = __webpack_require__(11);\n\t\n\tvar _Visibility2 = _interopRequireDefault(_Visibility);\n\t\n\tvar _Session = __webpack_require__(12);\n\t\n\tvar _Session2 = _interopRequireDefault(_Session);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tmodule.exports = { Scroll: _Scroll2.default, Visibility: _Visibility2.default, Session: _Session2.default };\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(7);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Scroll = function () {\n\t  function Scroll(element) {\n\t    _classCallCheck(this, Scroll);\n\t\n\t    this.word_count = 0;\n\t    this.viewportChecks = [];\n\t    this.setScrollCalc();\n\t    this.setContentElements(element);\n\t    this.update();\n\t    this.pubsub = new _utils.PubSub();\n\t    this.pubsub.subscribe('Scroll', this.update, this);\n\t  }\n\t\n\t  _createClass(Scroll, [{\n\t    key: 'setScrollCalc',\n\t    value: function setScrollCalc() {\n\t      if (typeof window.pageYOffset !== 'undefined') {\n\t        this.scrollCalc = function () {\n\t          return [window.pageXOffset, window.pageYOffset];\n\t        };\n\t      } else if (typeof document.documentElement.scrollTop !== 'undefined' && document.documentElement.scrollTop > 0) {\n\t        this.scrollCalc = function () {\n\t          return [document.documentElement.scrollLeft, document.documentElement.scrollTop];\n\t        };\n\t      } else if (typeof document.body.scrollTop !== 'undefined') {\n\t        this.scrollCalc = function () {\n\t          return [document.body.scrollLeft, document.body.scrollTop];\n\t        };\n\t      } else {\n\t        throw new Error('Not Supported');\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setContentElements',\n\t    value: function setContentElements(element) {\n\t      var self = this;\n\t      var elements = document.getElementsByClassName(element);\n\t      if (elements.length === 0) {\n\t        throw new Error('No Elements Found');\n\t      } else {\n\t        Object.keys(elements).forEach(function (key) {\n\t          self.word_count += elements[key].innerHTML.replace(/<\\/?[^>]+(>|$)/g, '').split(' ').length;\n\t          self.viewportChecks.push(elements[key]);\n\t        });\n\t        self.top = elements[0].getBoundingClientRect().top;\n\t        self.bottom = elements[elements.length - 1].getBoundingClientRect().bottom;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'inBounds',\n\t    value: function inBounds(el) {\n\t      var rect = el.getBoundingClientRect();\n\t      return rect.bottom > 0 && rect.right > 0 && rect.left < (window.innerWidth || document.documentElement.clientWidth) && rect.top < (window.innerHeight || document.documentElement.clientHeight);\n\t    }\n\t  }, {\n\t    key: 'update',\n\t    value: function update() {\n\t      var _scrollCalc = this.scrollCalc();\n\t\n\t      var _scrollCalc2 = _slicedToArray(_scrollCalc, 2);\n\t\n\t      this.xPos = _scrollCalc2[0];\n\t      this.yPos = _scrollCalc2[1];\n\t\n\t      this.elementInViewport = this.elementsInViewport();\n\t    }\n\t  }, {\n\t    key: 'elementsInViewport',\n\t    value: function elementsInViewport() {\n\t      var _this = this;\n\t\n\t      return this.viewportChecks.some(function (el) {\n\t        return _this.inBounds(el);\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return Scroll;\n\t}();\n\t\n\tmodule.exports = Scroll;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _Utils = __webpack_require__(8);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Adapters = __webpack_require__(9);\n\t\n\tvar _Adapters2 = _interopRequireDefault(_Adapters);\n\t\n\tvar _PubSub = __webpack_require__(10);\n\t\n\tvar _PubSub2 = _interopRequireDefault(_PubSub);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tmodule.exports = { $$: _Utils2.default, Adapters: _Adapters2.default, PubSub: _PubSub2.default };\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar $$ = function () {\n\t  function $$() {\n\t    _classCallCheck(this, $$);\n\t  }\n\t\n\t  _createClass($$, null, [{\n\t    key: \"extend\",\n\t    value: function extend(obj1, obj2) {\n\t      return Object.assign(Object.create(Object.prototype), obj1, obj2);\n\t    }\n\t  }]);\n\t\n\t  return $$;\n\t}();\n\t\n\tmodule.exports = $$;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar vhidden = void 0;\n\tvar vchange = void 0;\n\t\n\tif (typeof document.hidden !== 'undefined') {\n\t  // Opera 12.10 and Firefox 18 and later support\n\t  vhidden = 'hidden';\n\t  vchange = 'visibilitychange';\n\t} else if (typeof document.mozHidden !== 'undefined') {\n\t  vhidden = 'mozHidden';\n\t  vchange = 'mozvisibilitychange';\n\t} else if (typeof document.msHidden !== 'undefined') {\n\t  vhidden = 'msHidden';\n\t  vchange = 'msvisibilitychange';\n\t} else if (typeof document.webkitHidden !== 'undefined') {\n\t  vhidden = 'webkitHidden';\n\t  vchange = 'webkitvisibilitychange';\n\t}\n\t\n\tmodule.exports = { vhidden: vhidden, vchange: vchange };\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar handlers = [];\n\t\n\tvar PubSub = function () {\n\t  function PubSub() {\n\t    _classCallCheck(this, PubSub);\n\t\n\t    this.handlers = handlers;\n\t  }\n\t\n\t  _createClass(PubSub, [{\n\t    key: 'subscribe',\n\t    value: function subscribe(event, handler, context) {\n\t      var ctx = typeof context === 'undefined' ? handler : context;\n\t      this.handlers.push({ event: event, handler: handler.bind(ctx) });\n\t    }\n\t  }, {\n\t    key: 'publish',\n\t    value: function publish(event) {\n\t      var i = void 0;\n\t      for (i = 0; i < this.handlers.length; i++) {\n\t        if (this.handlers[i].event === event) {\n\t          this.handlers[i].handler.call();\n\t        }\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return PubSub;\n\t}();\n\t\n\tmodule.exports = PubSub;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(7);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Visibility = function () {\n\t  function Visibility() {\n\t    _classCallCheck(this, Visibility);\n\t\n\t    this.is_visible = true;\n\t    this.pubsub = new _utils.PubSub();\n\t    this.pubsub.subscribe('Visibility', this.update, this);\n\t  }\n\t\n\t  _createClass(Visibility, [{\n\t    key: 'update',\n\t    value: function update() {\n\t      this.is_visible = window.document[_utils.Adapters.vhidden];\n\t    }\n\t  }]);\n\t\n\t  return Visibility;\n\t}();\n\t\n\tmodule.exports = Visibility;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Session = function () {\n\t  function Session() {\n\t    _classCallCheck(this, Session);\n\t\n\t    this.session_id = this.sessionId();\n\t    this.referrer = this.referrer();\n\t    this.source_url = document.URL.replace(/\\/$/, '');\n\t  }\n\t\n\t  _createClass(Session, [{\n\t    key: 'sessionId',\n\t    value: function sessionId() {\n\t      var sessionId = window.sessionStorage.getItem('__engage_session');\n\t      if (sessionId == null) {\n\t        var newId = this.idTemplate();\n\t        window.sessionStorage.setItem('__engage_session', newId);\n\t        return newId;\n\t      }\n\t      return sessionId;\n\t    }\n\t  }, {\n\t    key: 'referrer',\n\t    value: function referrer() {\n\t      var url = document.referrer.replace(/\\/$/, '');\n\t      return url.match(location.hostname) ? url : '';\n\t    }\n\t  }, {\n\t    key: 'idTemplate',\n\t    value: function idTemplate() {\n\t      return '_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();\n\t    }\n\t  }]);\n\t\n\t  return Session;\n\t}();\n\t\n\tmodule.exports = Session;\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** engage.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap cbce4fdc5f1a1cea70f7\n **/","import engage from './base';\n\nwindow.engage = engage;\nmodule.exports = engage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import engage from './engage';\n\nmodule.exports = engage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base/index.js\n **/","import { Manager } from '../metrics';\nimport { $$ } from '../utils';\n\nlet instance = null;\nconst defaults = {\n  content: 'application/vnd.engage.api+json; charset=UTF-8',\n  url: 'http://api.engage.dev/v1/metrics',\n};\n\nclass engage {\n\n  constructor(options) {\n    if (!instance) { instance = this; }\n    this.options = $$.extend(defaults, options);\n    this.manager = new Manager(options);\n    this.emitter();\n  }\n\n  toJSON() {\n    const data = $$.extend({ api_key: this.options.api_key }, this.manager.inspect());\n    return JSON.stringify({ data });\n  }\n\n  format() {\n    return new Blob(\n      [this.toJSON()], { type: this.options.content }\n    );\n  }\n\n  emitter() {\n    setInterval(() => {\n      window.navigator.sendBeacon(this.options.url, this.format());\n    }, 2000);\n  }\n\n  static get instance() {\n    if (!instance) { throw new Error('Engage is not running'); }\n    return instance;\n  }\n\n  static set instance(val) {\n    if (instance) { instance = val; }\n  }\n\n  static run(options) {\n    if (!options) { throw new Error('No options passed'); }\n    if (!options.api_key) { throw new Error('No API Key passed'); }\n    if (!options.element) { throw new Error('No element option passed'); }\n    return new engage(options); // eslint-disable-line new-cap\n  }\n}\n\nmodule.exports = engage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base/engage.js\n **/","import Manager from './Manager';\n\nmodule.exports = { Manager };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/metrics/index.js\n **/","import { Scroll, Session, Visibility } from '../tracking';\nimport { Adapters, PubSub } from '../utils/';\n\nclass Manager {\n\n  constructor(options) {\n    this.options = options;\n    this.timestamp = Date.now();\n    this.pubsub = new PubSub();\n    this.scroll = new Scroll(options.element);\n    this.session = new Session();\n    this.visibility = new Visibility();\n    this.startTracking();\n  }\n\n  startTracking() {\n    window.addEventListener('scroll', () => this.pubsub.publish('Scroll'));\n    document.addEventListener(Adapters.vchange, () => this.pubsub.publish('Visibility'), false);\n  }\n\n  inspect() {\n    return {\n      timestamp: this.timestamp,\n      session_id: this.session.session_id,\n      referrer: this.session.referrer,\n      x_pos: this.scroll.xPos,\n      y_pos: this.scroll.yPos,\n      top: this.scroll.top,\n      bottom: this.scroll.bottom,\n      word_count: this.scroll.word_count,\n      is_visible: this.visibility.is_visible,\n      source_url: this.session.source_url,\n      in_viewport: this.scroll.elementInViewport,\n    };\n  }\n\n}\n\nmodule.exports = Manager;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/metrics/Manager.js\n **/","import Scroll from './Scroll';\nimport Visibility from './Visibility';\nimport Session from './Session';\n\nmodule.exports = { Scroll, Visibility, Session };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/index.js\n **/","import { PubSub } from '../utils/';\n\nclass Scroll {\n\n  constructor(element) {\n    this.word_count = 0;\n    this.viewportChecks = [];\n    this.setScrollCalc();\n    this.setContentElements(element);\n    this.update();\n    this.pubsub = new PubSub();\n    this.pubsub.subscribe('Scroll', this.update, this);\n  }\n\n  setScrollCalc() {\n    if (typeof window.pageYOffset !== 'undefined') {\n      this.scrollCalc = () =>\n        ([window.pageXOffset, window.pageYOffset]);\n    } else if (typeof document.documentElement.scrollTop !== 'undefined' &&\n    document.documentElement.scrollTop > 0) {\n      this.scrollCalc = () =>\n        ([document.documentElement.scrollLeft, document.documentElement.scrollTop]);\n    } else if (typeof document.body.scrollTop !== 'undefined') {\n      this.scrollCalc = () =>\n        ([document.body.scrollLeft, document.body.scrollTop]);\n    } else {\n      throw new Error('Not Supported');\n    }\n  }\n\n  setContentElements(element) {\n    const self = this;\n    const elements = document.getElementsByClassName(element);\n    if (elements.length === 0) {\n      throw new Error('No Elements Found');\n    } else {\n      Object.keys(elements).forEach((key) => {\n        self.word_count += elements[key].innerHTML.replace(/<\\/?[^>]+(>|$)/g, '').split(' ').length;\n        self.viewportChecks.push(elements[key]);\n      });\n      self.top = elements[0].getBoundingClientRect().top;\n      self.bottom = elements[elements.length - 1].getBoundingClientRect().bottom;\n    }\n  }\n\n  inBounds(el) {\n    const rect = el.getBoundingClientRect();\n    return rect.bottom > 0 &&\n      rect.right > 0 &&\n      rect.left < (window.innerWidth || document.documentElement.clientWidth) &&\n      rect.top < (window.innerHeight || document.documentElement.clientHeight);\n  }\n\n  update() {\n    [this.xPos, this.yPos] = this.scrollCalc();\n    this.elementInViewport = this.elementsInViewport();\n  }\n\n  elementsInViewport() {\n    return this.viewportChecks.some(el => this.inBounds(el));\n  }\n}\n\nmodule.exports = Scroll;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/Scroll.js\n **/","import $$ from './Utils';\nimport Adapters from './Adapters';\nimport PubSub from './PubSub';\n\nmodule.exports = { $$, Adapters, PubSub };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/index.js\n **/","class $$ {\n\n  static extend(obj1, obj2) {\n    return Object.assign(Object.create(Object.prototype), obj1, obj2);\n  }\n\n}\n\nmodule.exports = $$;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/Utils.js\n **/","let vhidden;\nlet vchange;\n\nif (typeof document.hidden !== 'undefined') { // Opera 12.10 and Firefox 18 and later support\n  vhidden = 'hidden';\n  vchange = 'visibilitychange';\n} else if (typeof document.mozHidden !== 'undefined') {\n  vhidden = 'mozHidden';\n  vchange = 'mozvisibilitychange';\n} else if (typeof document.msHidden !== 'undefined') {\n  vhidden = 'msHidden';\n  vchange = 'msvisibilitychange';\n} else if (typeof document.webkitHidden !== 'undefined') {\n  vhidden = 'webkitHidden';\n  vchange = 'webkitvisibilitychange';\n}\n\nmodule.exports = { vhidden, vchange };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/Adapters.js\n **/","const handlers = [];\n\nclass PubSub {\n\n  constructor() {\n    this.handlers = handlers;\n  }\n\n  subscribe(event, handler, context) {\n    const ctx = (typeof context === 'undefined') ? handler : context;\n    this.handlers.push({ event, handler: handler.bind(ctx) });\n  }\n\n  publish(event) {\n    let i;\n    for (i = 0; i < this.handlers.length; i++) {\n      if (this.handlers[i].event === event) {\n        this.handlers[i].handler.call();\n      }\n    }\n  }\n}\n\nmodule.exports = PubSub;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/PubSub.js\n **/","import { Adapters, PubSub } from '../utils/';\n\nclass Visibility {\n\n  constructor() {\n    this.is_visible = true;\n    this.pubsub = new PubSub();\n    this.pubsub.subscribe('Visibility', this.update, this);\n  }\n\n  update() {\n    this.is_visible = window.document[Adapters.vhidden];\n  }\n\n}\n\nmodule.exports = Visibility;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/Visibility.js\n **/","class Session {\n\n  constructor() {\n    this.session_id = this.sessionId();\n    this.referrer = this.referrer();\n    this.source_url = document.URL.replace(/\\/$/, '');\n  }\n\n  sessionId() {\n    const sessionId = window.sessionStorage.getItem('__engage_session');\n    if (sessionId == null) {\n      const newId = this.idTemplate();\n      window.sessionStorage.setItem('__engage_session', newId);\n      return newId;\n    }\n    return sessionId;\n  }\n\n  referrer() {\n    const url = document.referrer.replace(/\\/$/, '');\n    return url.match(location.hostname) ? url : '';\n  }\n\n  idTemplate() {\n    return `_${Math.random().toString(36).substr(2, 9)}_${Date.now()}`;\n  }\n\n}\n\nmodule.exports = Session;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/Session.js\n **/"],"sourceRoot":""}