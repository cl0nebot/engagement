{"version":3,"sources":["webpack:///webpack/bootstrap bb532bf1c1d5e121c916","webpack:///./src/index.js","webpack:///./src/base/index.js","webpack:///./src/base/engage.js","webpack:///./src/metrics/index.js","webpack:///./src/metrics/Manager.js","webpack:///./src/tracking/index.js","webpack:///./src/tracking/Scroll.js","webpack:///./src/tracking/Visibility.js","webpack:///./src/utils/index.js","webpack:///./src/utils/Utils.js","webpack:///./src/utils/Adapters.js","webpack:///./src/tracking/Session.js"],"names":[],"mappings":"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","file":"engage.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap bb532bf1c1d5e121c916\n **/","import engage from './base';\n\nwindow.engage = engage;\nmodule.exports = engage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import engage from './engage';\n\nmodule.exports = engage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base/index.js\n **/","import { Manager } from '../metrics';\nimport { $$ } from '../utils';\n\nlet instance = null;\nconst defaults = {\n  content: 'application/vnd.engage.api+json; charset=UTF-8',\n  url: 'http://api.engage.dev/v1/reports',\n};\n\nclass engage {\n\n  constructor(options) {\n    if (!instance) { instance = this; }\n    this.options = $$.extend(defaults, options);\n    this.manager = new Manager(options);\n    this.emitter();\n  }\n\n  toJSON() {\n    const data = $$.extend({ api_key: this.options.api_key }, this.manager.inspect());\n    return JSON.stringify({ data });\n  }\n\n  format() {\n    return new Blob(\n      [this.toJSON()], { type: this.options.content }\n    );\n  }\n\n  emitter() {\n    setInterval(() => {\n      window.navigator.sendBeacon(this.options.url, this.format());\n    }, 2000);\n  }\n\n  static get instance() {\n    if (!instance) { throw new Error('Engage is not running'); }\n    return instance;\n  }\n\n  static set instance(val) {\n    if (instance) { instance = val; }\n  }\n\n  static run(options) {\n    if (!options) { throw new Error('No options passed'); }\n    if (!options.api_key) { throw new Error('No API Key passed'); }\n    if (!options.element) { throw new Error('No element option passed'); }\n    return new engage(options); // eslint-disable-line new-cap\n  }\n}\n\nmodule.exports = engage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base/engage.js\n **/","import Manager from './Manager';\n\nmodule.exports = { Manager };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/metrics/index.js\n **/","import { Scroll, Session, Visibility } from '../tracking';\nimport { Adapters } from '../utils/';\n\nclass Manager {\n\n  constructor(options) {\n    this.options = options;\n    this.timestamp = Date.now();\n    this.scroll = new Scroll(options.element);\n    this.session = new Session();\n    this.visibility = new Visibility();\n    this.startTracking();\n  }\n\n  startTracking() {\n    window.addEventListener('scroll', this.scroll.update.bind(this.scroll), false);\n    document.addEventListener(\n      Adapters.vchange, this.visibility.update.bind(this.visibility), false\n    );\n  }\n\n  inspect() {\n    return {\n      timestamp: this.timestamp,\n      session_id: this.session.session_id,\n      referrer: this.session.referrer,\n      x_pos: this.scroll.xPos,\n      y_pos: this.scroll.yPos,\n      top: this.scroll.top,\n      bottom: this.scroll.bottom,\n      word_count: this.scroll.word_count,\n      is_visible: this.visibility.is_visible,\n      source_url: this.session.source_url,\n      in_viewport: this.scroll.elementInViewport,\n    };\n  }\n\n}\n\nmodule.exports = Manager;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/metrics/Manager.js\n **/","import Scroll from './Scroll';\nimport Visibility from './Visibility';\nimport Session from './Session';\n\nmodule.exports = { Scroll, Visibility, Session };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/index.js\n **/","class Scroll {\n\n  constructor(element) {\n    this.word_count = 0;\n    this.viewportChecks = [];\n    this.setScrollCalc();\n    this.setContentElements(element);\n    this.update();\n  }\n\n  setScrollCalc() {\n    if (typeof window.pageYOffset !== 'undefined') {\n      this.scrollCalc = () =>\n        ([window.pageXOffset, window.pageYOffset]);\n    } else if (typeof document.documentElement.scrollTop !== 'undefined' &&\n    document.documentElement.scrollTop > 0) {\n      this.scrollCalc = () =>\n        ([document.documentElement.scrollLeft, document.documentElement.scrollTop]);\n    } else if (typeof document.body.scrollTop !== 'undefined') {\n      this.scrollCalc = () =>\n        ([document.body.scrollLeft, document.body.scrollTop]);\n    } else {\n      throw new Error('Not Supported');\n    }\n  }\n\n  setContentElements(element) {\n    const self = this;\n    const elements = document.getElementsByClassName(element);\n    if (elements.length === 0) {\n      throw new Error('No Elements Found');\n    } else {\n      Object.keys(elements).forEach((key) => {\n        self.word_count += elements[key].innerHTML.replace(/<\\/?[^>]+(>|$)/g, '').split(' ').length;\n        self.viewportChecks.push(elements[key]);\n      });\n      self.top = elements[0].getBoundingClientRect().top;\n      self.bottom = elements[elements.length - 1].getBoundingClientRect().bottom;\n    }\n  }\n\n  inBounds(el) {\n    const rect = el.getBoundingClientRect();\n    return rect.bottom > 0 &&\n      rect.right > 0 &&\n      rect.left < (window.innerWidth || document.documentElement.clientWidth) &&\n      rect.top < (window.innerHeight || document.documentElement.clientHeight);\n  }\n\n  update() {\n    [this.xPos, this.yPos] = this.scrollCalc();\n    this.elementInViewport = this.elementsInViewport();\n  }\n\n  elementsInViewport() {\n    return this.viewportChecks.some(el => this.inBounds(el));\n  }\n}\n\nmodule.exports = Scroll;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/Scroll.js\n **/","import { Adapters } from '../utils/';\n\nclass Visibility {\n\n  constructor() {\n    this.is_visible = true;\n  }\n\n  update() {\n    this.is_visible = window.document[Adapters.vhidden];\n  }\n\n}\n\nmodule.exports = Visibility;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/Visibility.js\n **/","import $$ from './Utils';\nimport Adapters from './Adapters';\n\nmodule.exports = { $$, Adapters };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/index.js\n **/","class $$ {\n\n  static extend(obj1, obj2) {\n    return Object.assign(Object.create(Object.prototype), obj1, obj2);\n  }\n\n}\n\nmodule.exports = $$;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/Utils.js\n **/","let vhidden;\nlet vchange;\n\nif (typeof document.hidden !== 'undefined') { // Opera 12.10 and Firefox 18 and later support\n  vhidden = 'hidden';\n  vchange = 'visibilitychange';\n} else if (typeof document.mozHidden !== 'undefined') {\n  vhidden = 'mozHidden';\n  vchange = 'mozvisibilitychange';\n} else if (typeof document.msHidden !== 'undefined') {\n  vhidden = 'msHidden';\n  vchange = 'msvisibilitychange';\n} else if (typeof document.webkitHidden !== 'undefined') {\n  vhidden = 'webkitHidden';\n  vchange = 'webkitvisibilitychange';\n}\n\nmodule.exports = { vhidden, vchange };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/Adapters.js\n **/","class Session {\n\n  constructor() {\n    this.session_id = this.sessionId();\n    this.referrer = this.referrer();\n    this.source_url = document.URL.replace(/\\/$/, '');\n  }\n\n  sessionId() {\n    const sessionId = window.sessionStorage.getItem('__engage_session');\n    if (sessionId == null) {\n      const newId = this.idTemplate();\n      window.sessionStorage.setItem('__engage_session', newId);\n      return newId;\n    }\n    return sessionId;\n  }\n\n  referrer() {\n    const url = document.referrer.replace(/\\/$/, '');\n    return url.match(location.hostname) ? url : '';\n  }\n\n  idTemplate() {\n    return `_${Math.random().toString(36).substr(2, 9)}_${Date.now()}`;\n  }\n\n}\n\nmodule.exports = Session;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tracking/Session.js\n **/"],"sourceRoot":""}