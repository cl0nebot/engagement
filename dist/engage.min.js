var engage=function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(1),r=i(o);window.engage=r.default,t.exports=r.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(2),r=i(o);t.exports=r.default},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(3),s=n(7),u=null,c={content:"application/vnd.engage.api+json; charset=UTF-8",url:"http://api.engage.dev/v1/metrics"},a=function(){function t(e){i(this,t),u||(u=this),this.options=s.$$.extend(c,e),this.manager=new r.Manager(e),this.emitter()}return t.prototype.toJSON=function(){var t=s.$$.extend({api_key_id:this.options.api_key},this.manager.inspect());return JSON.stringify({data:t})},t.prototype.format=function(){return new window.Blob([this.toJSON()],{type:this.options.content})},t.prototype.emitter=function(){var t=this;setInterval(function(){window.navigator.sendBeacon(t.options.url,t.format())},2e3)},t.run=function(e){if(!e)throw new Error("No options passed");if(!e.api_key)throw new Error("No API Key passed");if(!e.element)throw new Error("No element option passed");return new t(e)},o(t,null,[{key:"instance",get:function(){if(!u)throw new Error("Engage is not running");return u},set:function(t){u&&(u=t)}}]),t}();t.exports=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(4),r=i(o);t.exports={Manager:r.default}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(5),r=n(7),s=function(){function t(e){i(this,t),this.options=e,this.timestamp=(new Date).toISOString(),this.pubsub=new r.PubSub,this.scroll=new o.Scroll(e.element),this.session=new o.Session,this.visibility=new o.Visibility,this.startTracking()}return t.prototype.startTracking=function(){var t=this;window.addEventListener("scroll",function(){return t.pubsub.publish("Scroll")}),document.addEventListener(r.Adapters.vchange,function(){return t.pubsub.publish("Visibility")},!1)},t.prototype.inspect=function(){return{timestamp:this.timestamp,session_id:this.session.session_id,referrer:this.session.referrer,x_pos:this.scroll.xPos,y_pos:this.scroll.yPos,top:this.scroll.top,bottom:this.scroll.bottom,word_count:this.scroll.word_count,is_visible:this.visibility.is_visible,source_url:this.session.source_url,in_viewport:this.scroll.elementInViewport}},t}();t.exports=s},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(6),r=i(o),s=n(11),u=i(s),c=n(12),a=i(c);t.exports={Scroll:r.default,Visibility:u.default,Session:a.default}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(7),r=function(){function t(e){i(this,t),this.word_count=0,this.viewportChecks=[],this.setScrollCalc(),this.setContentElements(e),this.update(),this.pubsub=new o.PubSub,this.pubsub.subscribe("Scroll",this.update,this)}return t.prototype.setScrollCalc=function(){if("undefined"!=typeof window.pageYOffset)this.scrollCalc=function(){return[window.pageXOffset,window.pageYOffset]};else if("undefined"!=typeof document.documentElement.scrollTop&&document.documentElement.scrollTop>0)this.scrollCalc=function(){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]};else{if("undefined"==typeof document.body.scrollTop)throw new Error("Not Supported");this.scrollCalc=function(){return[document.body.scrollLeft,document.body.scrollTop]}}},t.prototype.setContentElements=function(t){var e=this,n=document.querySelectorAll(t);if(0===n.length)throw new Error("No Elements Found");Object.keys(n).forEach(function(t){e.word_count+=n[t].innerHTML.replace(/<\/?[^>]+(>|$)/g,"").split(" ").length,e.viewportChecks.push(n[t])}),e.top=n[0].getBoundingClientRect().top,e.bottom=n[n.length-1].getBoundingClientRect().bottom},t.inBounds=function(t){var e=t.getBoundingClientRect();return e.bottom>0&&e.right>0&&e.left<(window.innerWidth||document.documentElement.clientWidth)&&e.top<(window.innerHeight||document.documentElement.clientHeight)},t.prototype.update=function(){var t=this.scrollCalc();this.xPos=t[0],this.yPos=t[1],this.elementInViewport=this.elementsInViewport()},t.prototype.elementsInViewport=function(){return this.viewportChecks.some(function(e){return t.inBounds(e)})},t}();t.exports=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(8),r=i(o),s=n(9),u=i(s),c=n(10),a=i(c);t.exports={$$:r.default,Adapters:u.default,PubSub:a.default}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){n(this,t)}return t.extend=function(t,e){return Object.assign(Object.create(Object.prototype),t,e)},t}();t.exports=i},function(t,e){"use strict";var n=void 0,i=void 0;"undefined"!=typeof document.hidden?(n="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(n="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(n="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(n="webkitHidden",i="webkitvisibilitychange"),t.exports={vhidden:n,vchange:i}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=[],o=function(){function t(){n(this,t),this.handlers=i}return t.prototype.subscribe=function(t,e,n){var i="undefined"==typeof n?e:n;this.handlers.push({event:t,handler:e.bind(i)})},t.prototype.publish=function(t){var e=void 0;for(e=0;e<this.handlers.length;e+=1)this.handlers[e].event===t&&this.handlers[e].handler.call()},t}();t.exports=o},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(7),r=function(){function t(){i(this,t),this.is_visible=!0,this.pubsub=new o.PubSub,this.pubsub.subscribe("Visibility",this.update,this)}return t.prototype.update=function(){this.is_visible=window.document[o.Adapters.vhidden]},t}();t.exports=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){n(this,t),this.session_id=t.sessionId(),this.referrer=t.referrer(),this.source_url=document.URL.replace(/\/$/,"")}return t.sessionId=function e(){var e=window.sessionStorage.getItem("__engage_session");if(null==e){var n=t.idTemplate();return window.sessionStorage.setItem("__engage_session",n),n}return e},t.referrer=function(){var t=document.referrer.replace(/\/$/,"");return t.match(location.hostname)?t:""},t.idTemplate=function(){return"_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()},t}();t.exports=i}]);
//# sourceMappingURL=engage.min.js.map