var engage=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i);window.engage=o.default,e.engage=o.default,t.default=o.default}).call(t,function(){return this}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=o.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(3),u=function(e){return e&&e.__esModule?e:{default:e}}(s),a=null,c={content:"application/vnd.engage.api+json; charset=UTF-8",url:"http://api.engage.dev/v1/metrics"},l=function(){function e(t){i(this,e),a||(a=this),this.options=o(c,t),this.manager=new u.default(t),this.emitter()}return e.prototype.toJSON=function(){var e=o({api_key_id:this.options.api_key},this.options.dimensions,this.manager.inspect());return JSON.stringify({data:e})},e.prototype.format=function(){return new window.Blob([this.toJSON()],{type:this.options.content})},e.prototype.emitter=function(){var e=this;setInterval(function(){window.navigator.sendBeacon(e.options.url,e.format())},2e3)},e.run=function(t){if(!t)throw new Error("No options passed");if(!t.api_key)throw new Error("No API Key passed");if(!t.element)throw new Error("No element option passed");return new e(t)},r(e,null,[{key:"instance",get:function(){if(!a)throw new Error("Engage is not running");return a},set:function(e){a&&(a=e)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=o.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=n(7),s=function(){function e(t){i(this,e),this.options=t,this.timestamp=(new Date).toISOString(),this.pubsub=new r.PubSub,this.scroll=new o.Scroll(t.element),this.session=new o.Session,this.visibility=new o.Visibility,this.startTracking()}return e.prototype.startTracking=function(){var e=this;window.addEventListener("scroll",function(){return e.pubsub.publish("Scroll")}),document.addEventListener(r.Adapters.vchange,function(){return e.pubsub.publish("Visibility")},!1)},e.prototype.inspect=function(){return{timestamp:this.timestamp,session_id:this.session.session_id,referrer:this.session.referrer,x_pos:this.scroll.xPos,y_pos:this.scroll.yPos,top:this.scroll.top,bottom:this.scroll.bottom,word_count:this.scroll.word_count,is_visible:this.visibility.is_visible,source_url:this.session.source_url,in_viewport:this.scroll.elementInViewport}},e}();t.default=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Session=t.Visibility=t.Scroll=void 0;var o=n(6),r=i(o),s=n(11),u=i(s),a=n(12),c=i(a);t.Scroll=r.default,t.Visibility=u.default,t.Session=c.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=void 0,s=function(){function e(t){i(this,e),this.setContentElements(t),this.update(),this.pubsub=new o.PubSub,this.pubsub.subscribe("Scroll",this.update,this)}return e.prototype.setContentElements=function(e){var t=this;if(r=o.$$.find(e),0===r.length)throw new Error("No Elements Found");this.top=r[0].getBoundingClientRect().top,this.bottom=r[r.length-1].getBoundingClientRect().bottom,r.forEach(function(e){t.word_count=(t.word_count||0)+e.innerHTML.replace(/<\/?[^>]+(>|$)/g,"").split(" ").length})},e.prototype.update=function(){var t=o.Adapters.scrollCalc();this.xPos=t[0],this.yPos=t[1],this.elementInViewport=e.elementsInViewport()},e.inBounds=function(e){var t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.left<(window.innerWidth||document.documentElement.clientWidth)&&t.top<(window.innerHeight||document.documentElement.clientHeight)},e.elementsInViewport=function(){return r.some(function(t){return e.inBounds(t)})},e}();t.default=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PubSub=t.Adapters=t.$$=void 0;var o=n(8),r=i(o),s=n(9),u=i(s),a=n(10),c=i(a);t.$$=r.default,t.Adapters=u.default,t.PubSub=c.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){n(this,e)}return e.find=function(e){return Array.from(document.querySelectorAll(e))},e}();t.default=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};n.scrollCalc=function(){if(void 0===window.pageYOffset)throw new Error("Not Supported");return[window.pageXOffset,window.pageYOffset]},void 0!==document.hidden?(n.vhidden="hidden",n.vchange="visibilitychange"):void 0!==document.mozHidden?(n.vhidden="mozHidden",n.vchange="mozvisibilitychange"):void 0!==document.msHidden?(n.vhidden="msHidden",n.vchange="msvisibilitychange"):void 0!==document.webkitHidden&&(n.vhidden="webkitHidden",n.vchange="webkitvisibilitychange"),t.default=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=[],o=function(){function e(){n(this,e),this.handlers=i}return e.prototype.subscribe=function(e,t,n){var i=void 0===n?t:n;this.handlers.push({event:e,handler:t.bind(i)})},e.prototype.publish=function(e){var t=void 0;for(t=0;t<this.handlers.length;t+=1)this.handlers[t].event===e&&this.handlers[t].handler.call()},e}();t.default=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(){function e(){i(this,e),this.is_visible=!0,this.pubsub=new o.PubSub,this.pubsub.subscribe("Visibility",this.update,this)}return e.prototype.update=function(){this.is_visible=window.document[o.Adapters.vhidden]},e}();t.default=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){n(this,e),this.session_id=e.sessionId(),this.referrer=e.referrer(),this.source_url=document.URL.replace(/\/$/,"")}return e.sessionId=function(){var t=window.sessionStorage.getItem("__engage_session");if(null==t){var n=e.idTemplate();return window.sessionStorage.setItem("__engage_session",n),n}return t},e.referrer=function(){var e=document.referrer.replace(/\/$/,"");return e.match(location.hostname)?e:""},e.idTemplate=function(){return"_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()},e}();t.default=i}]);