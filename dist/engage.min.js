var engage=function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";var i=e(1),o=function(t){return t&&t.__esModule?t:{default:t}}(i);window.engage=o.default,t.exports=o.default},function(t,n,e){"use strict";var i=e(2),o=function(t){return t&&t.__esModule?t:{default:t}}(i);t.exports=o.default},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},r=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),s=e(3),u=null,a={content:"application/vnd.engage.api+json; charset=UTF-8",url:"http://api.engage.dev/v1/metrics"},c=function(){function t(n){i(this,t),u||(u=this),this.options=o(a,n),this.manager=new s.Manager(n),this.emitter()}return t.prototype.toJSON=function(){var t=o({api_key_id:this.options.api_key},this.options.dimensions,this.manager.inspect());return JSON.stringify({data:t})},t.prototype.format=function(){return new window.Blob([this.toJSON()],{type:this.options.content})},t.prototype.emitter=function(){var t=this;setInterval(function(){window.navigator.sendBeacon(t.options.url,t.format())},2e3)},t.run=function(n){if(!n)throw new Error("No options passed");if(!n.api_key)throw new Error("No API Key passed");if(!n.element)throw new Error("No element option passed");return new t(n)},r(t,null,[{key:"instance",get:function(){if(!u)throw new Error("Engage is not running");return u},set:function(t){u&&(u=t)}}]),t}();t.exports=c},function(t,n,e){"use strict";var i=e(4),o=function(t){return t&&t.__esModule?t:{default:t}}(i);t.exports={Manager:o.default}},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=e(5),r=e(7),s=function(){function t(n){i(this,t),this.options=n,this.timestamp=(new Date).toISOString(),this.pubsub=new r.PubSub,this.scroll=new o.Scroll(n.element),this.session=new o.Session,this.visibility=new o.Visibility,this.startTracking()}return t.prototype.startTracking=function(){var t=this;window.addEventListener("scroll",function(){return t.pubsub.publish("Scroll")}),document.addEventListener(r.Adapters.vchange,function(){return t.pubsub.publish("Visibility")},!1)},t.prototype.inspect=function(){return{timestamp:this.timestamp,session_id:this.session.session_id,referrer:this.session.referrer,x_pos:this.scroll.xPos,y_pos:this.scroll.yPos,top:this.scroll.top,bottom:this.scroll.bottom,word_count:this.scroll.word_count,is_visible:this.visibility.is_visible,source_url:this.session.source_url,in_viewport:this.scroll.elementInViewport}},t}();t.exports=s},function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=e(6),r=i(o),s=e(11),u=i(s),a=e(12),c=i(a);t.exports={Scroll:r.default,Visibility:u.default,Session:c.default}},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=e(7),r=void 0,s=function(){function t(n){i(this,t),this.setContentElements(n),this.update(),this.pubsub=new o.PubSub,this.pubsub.subscribe("Scroll",this.update,this)}return t.prototype.setContentElements=function(t){var n=this;if(r=o.$$.find(t),0===r.length)throw new Error("No Elements Found");this.top=r[0].getBoundingClientRect().top,this.bottom=r[r.length-1].getBoundingClientRect().bottom,r.forEach(function(t){n.word_count=(n.word_count||0)+t.innerHTML.replace(/<\/?[^>]+(>|$)/g,"").split(" ").length})},t.prototype.update=function(){var n=o.Adapters.scrollCalc();this.xPos=n[0],this.yPos=n[1],this.elementInViewport=t.elementsInViewport()},t.inBounds=function(t){var n=t.getBoundingClientRect();return n.bottom>0&&n.right>0&&n.left<(window.innerWidth||document.documentElement.clientWidth)&&n.top<(window.innerHeight||document.documentElement.clientHeight)},t.elementsInViewport=function(){return r.some(function(n){return t.inBounds(n)})},t}();t.exports=s},function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=e(8),r=i(o),s=e(9),u=i(s),a=e(10),c=i(a);t.exports={$$:r.default,Adapters:u.default,PubSub:c.default}},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){e(this,t)}return t.find=function(t){return Array.from(document.querySelectorAll(t))},t}();t.exports=i},function(t,n){"use strict";var e=void 0,i=void 0,o=function(){if(void 0===window.pageYOffset)throw new Error("Not Supported");return[window.pageXOffset,window.pageYOffset]};void 0!==document.hidden?(e="hidden",i="visibilitychange"):void 0!==document.mozHidden?(e="mozHidden",i="mozvisibilitychange"):void 0!==document.msHidden?(e="msHidden",i="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",i="webkitvisibilitychange"),t.exports={vhidden:e,vchange:i,scrollCalc:o}},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=[],o=function(){function t(){e(this,t),this.handlers=i}return t.prototype.subscribe=function(t,n,e){var i=void 0===e?n:e;this.handlers.push({event:t,handler:n.bind(i)})},t.prototype.publish=function(t){var n=void 0;for(n=0;n<this.handlers.length;n+=1)this.handlers[n].event===t&&this.handlers[n].handler.call()},t}();t.exports=o},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=e(7),r=function(){function t(){i(this,t),this.is_visible=!0,this.pubsub=new o.PubSub,this.pubsub.subscribe("Visibility",this.update,this)}return t.prototype.update=function(){this.is_visible=window.document[o.Adapters.vhidden]},t}();t.exports=r},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){e(this,t),this.session_id=t.sessionId(),this.referrer=t.referrer(),this.source_url=document.URL.replace(/\/$/,"")}return t.sessionId=function(){var n=window.sessionStorage.getItem("__engage_session");if(null==n){var e=t.idTemplate();return window.sessionStorage.setItem("__engage_session",e),e}return n},t.referrer=function(){var t=document.referrer.replace(/\/$/,"");return t.match(location.hostname)?t:""},t.idTemplate=function(){return"_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()},t}();t.exports=i}]);