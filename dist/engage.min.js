var engage=function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var i=n(1),r=o(i);window.engage=r["default"],t.exports=r["default"]},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var i=n(2),r=o(i);t.exports=r["default"]},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(3),s=n(7),u=null,c={content:"application/vnd.engage.api+json; charset=UTF-8",url:"http://api.engage.dev/v1/metrics"},a=function(){function t(e){o(this,t),u||(u=this),this.options=s.$$.extend(c,e),this.manager=new r.Manager(e),this.emitter()}return t.prototype.toJSON=function(){var t=s.$$.extend({api_key:this.options.api_key},this.manager.inspect());return JSON.stringify({data:t})},t.prototype.format=function(){return new Blob([this.toJSON()],{type:this.options.content})},t.prototype.emitter=function(){var t=this;setInterval(function(){window.navigator.sendBeacon(t.options.url,t.format())},2e3)},t.run=function(e){if(!e)throw new Error("No options passed");if(!e.api_key)throw new Error("No API Key passed");if(!e.element)throw new Error("No element option passed");return new t(e)},i(t,null,[{key:"instance",get:function(){if(!u)throw new Error("Engage is not running");return u},set:function(t){u&&(u=t)}}]),t}();t.exports=a},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var i=n(4),r=o(i);t.exports={Manager:r["default"]}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(5),r=n(7),s=function(){function t(e){o(this,t),this.options=e,this.timestamp=Date.now(),this.pubsub=new r.PubSub,this.scroll=new i.Scroll(e.element),this.session=new i.Session,this.visibility=new i.Visibility,this.startTracking()}return t.prototype.startTracking=function(){var t=this;window.addEventListener("scroll",function(){return t.pubsub.publish("Scroll")}),document.addEventListener(r.Adapters.vchange,function(){return t.pubsub.publish("Visibility")},!1)},t.prototype.inspect=function(){return{timestamp:this.timestamp,session_id:this.session.session_id,referrer:this.session.referrer,x_pos:this.scroll.xPos,y_pos:this.scroll.yPos,top:this.scroll.top,bottom:this.scroll.bottom,word_count:this.scroll.word_count,is_visible:this.visibility.is_visible,source_url:this.session.source_url,in_viewport:this.scroll.elementInViewport}},t}();t.exports=s},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var i=n(6),r=o(i),s=n(11),u=o(s),c=n(12),a=o(c);t.exports={Scroll:r["default"],Visibility:u["default"],Session:a["default"]}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);o=!0);}catch(c){i=!0,r=c}finally{try{!o&&u["return"]&&u["return"]()}finally{if(i)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=n(7),s=function(){function t(e){o(this,t),this.word_count=0,this.viewportChecks=[],this.setScrollCalc(),this.setContentElements(e),this.update(),this.pubsub=new r.PubSub,this.pubsub.subscribe("Scroll",this.update,this)}return t.prototype.setScrollCalc=function(){if("undefined"!=typeof window.pageYOffset)this.scrollCalc=function(){return[window.pageXOffset,window.pageYOffset]};else if("undefined"!=typeof document.documentElement.scrollTop&&document.documentElement.scrollTop>0)this.scrollCalc=function(){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]};else{if("undefined"==typeof document.body.scrollTop)throw new Error("Not Supported");this.scrollCalc=function(){return[document.body.scrollLeft,document.body.scrollTop]}}},t.prototype.setContentElements=function(t){var e=this,n=document.getElementsByClassName(t);if(0===n.length)throw new Error("No Elements Found");Object.keys(n).forEach(function(t){e.word_count+=n[t].innerHTML.replace(/<\/?[^>]+(>|$)/g,"").split(" ").length,e.viewportChecks.push(n[t])}),e.top=n[0].getBoundingClientRect().top,e.bottom=n[n.length-1].getBoundingClientRect().bottom},t.prototype.inBounds=function(t){var e=t.getBoundingClientRect();return e.bottom>0&&e.right>0&&e.left<(window.innerWidth||document.documentElement.clientWidth)&&e.top<(window.innerHeight||document.documentElement.clientHeight)},t.prototype.update=function(){var t=this.scrollCalc(),e=i(t,2);this.xPos=e[0],this.yPos=e[1],this.elementInViewport=this.elementsInViewport()},t.prototype.elementsInViewport=function(){var t=this;return this.viewportChecks.some(function(e){return t.inBounds(e)})},t}();t.exports=s},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var i=n(8),r=o(i),s=n(9),u=o(s),c=n(10),a=o(c);t.exports={$$:r["default"],Adapters:u["default"],PubSub:a["default"]}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(){n(this,t)}return t.extend=function(t,e){return Object.assign(Object.create(Object.prototype),t,e)},t}();t.exports=o},function(t,e){"use strict";var n=void 0,o=void 0;"undefined"!=typeof document.hidden?(n="hidden",o="visibilitychange"):"undefined"!=typeof document.mozHidden?(n="mozHidden",o="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(n="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(n="webkitHidden",o="webkitvisibilitychange"),t.exports={vhidden:n,vchange:o}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=[],i=function(){function t(){n(this,t),this.handlers=o}return t.prototype.subscribe=function(t,e,n){var o="undefined"==typeof n?e:n;this.handlers.push({event:t,handler:e.bind(o)})},t.prototype.publish=function(t){var e=void 0;for(e=0;e<this.handlers.length;e++)this.handlers[e].event===t&&this.handlers[e].handler.call()},t}();t.exports=i},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(7),r=function(){function t(){o(this,t),this.is_visible=!0,this.pubsub=new i.PubSub,this.pubsub.subscribe("Visibility",this.update,this)}return t.prototype.update=function(){this.is_visible=window.document[i.Adapters.vhidden]},t}();t.exports=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(){n(this,t),this.session_id=this.sessionId(),this.referrer=this.referrer(),this.source_url=document.URL.replace(/\/$/,"")}return t.prototype.sessionId=function e(){var e=window.sessionStorage.getItem("__engage_session");if(null==e){var t=this.idTemplate();return window.sessionStorage.setItem("__engage_session",t),t}return e},t.prototype.referrer=function(){var t=document.referrer.replace(/\/$/,"");return t.match(location.hostname)?t:""},t.prototype.idTemplate=function(){return"_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()},t}();t.exports=o}]);
//# sourceMappingURL=engage.min.js.map