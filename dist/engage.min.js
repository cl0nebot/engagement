var engage=function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(1),o=i(r);window.engage=o["default"],e.exports=o["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(2),o=i(r);e.exports=o["default"]},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(3),s=n(8),u=null,a={content:"application/vnd.engage.api+json; charset=UTF-8",url:"http://api.engage.dev/v1/reports"},c=function(){function e(t){i(this,e),u||(u=this),this.options=s.$$.extend(a,t),this.manager=new o.Manager(t),this.emitter()}return r(e,[{key:"toJSON",value:function(){var e=s.$$.extend({api_key:this.options.api_key},this.manager.inspect());return JSON.stringify({data:e})}},{key:"format",value:function(){return new Blob([this.toJSON()],{type:this.options.content})}},{key:"emitter",value:function(){var e=this;setInterval(function(){window.navigator.sendBeacon(e.options.url,e.format())},2e3)}}],[{key:"run",value:function(t){if(!t)throw new Error("No options passed");if(!t.api_key)throw new Error("No API Key passed");if(!t.element)throw new Error("No element option passed");return new e(t)}},{key:"instance",get:function(){if(!u)throw new Error("Engage is not running");return u},set:function(e){u&&(u=e)}}]),e}();e.exports=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(4),o=i(r);e.exports={Manager:o["default"]}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(5),s=n(8),u=function(){function e(t){i(this,e),this.options=t,this.timestamp=Date.now(),this.scroll=new o.Scroll(t.element),this.session=new o.Session,this.visibility=new o.Visibility,this.startTracking()}return r(e,[{key:"startTracking",value:function(){window.addEventListener("scroll",this.scroll.update.bind(this.scroll),!1),document.addEventListener(s.Adapters.vchange,this.visibility.update.bind(this.visibility),!1)}},{key:"inspect",value:function(){return{timestamp:this.timestamp,session_id:this.session.session_id,referrer:this.session.referrer,x_pos:this.scroll.xPos,y_pos:this.scroll.yPos,top:this.scroll.top,bottom:this.scroll.bottom,word_count:this.scroll.word_count,is_visible:this.visibility.is_visible,source_url:this.session.source_url,in_viewport:this.scroll.elementInViewport}}}]),e}();e.exports=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(6),o=i(r),s=n(7),u=i(s),a=n(11),c=i(a);e.exports={Scroll:o["default"],Visibility:u["default"],Session:c["default"]}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(a){r=!0,o=a}finally{try{!i&&u["return"]&&u["return"]()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){n(this,e),this.word_count=0,this.viewportChecks=[],this.setScrollCalc(),this.setContentElements(t),this.update()}return r(e,[{key:"setScrollCalc",value:function(){if("undefined"!=typeof window.pageYOffset)this.scrollCalc=function(){return[window.pageXOffset,window.pageYOffset]};else if("undefined"!=typeof document.documentElement.scrollTop&&document.documentElement.scrollTop>0)this.scrollCalc=function(){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]};else{if("undefined"==typeof document.body.scrollTop)throw new Error("Not Supported");this.scrollCalc=function(){return[document.body.scrollLeft,document.body.scrollTop]}}}},{key:"setContentElements",value:function(e){var t=this,n=document.getElementsByClassName(e);if(0===n.length)throw new Error("No Elements Found");Object.keys(n).forEach(function(e){t.word_count+=n[e].innerHTML.replace(/<\/?[^>]+(>|$)/g,"").split(" ").length,t.viewportChecks.push(n[e])}),t.top=n[0].getBoundingClientRect().top,t.bottom=n[n.length-1].getBoundingClientRect().bottom}},{key:"inBounds",value:function(e){var t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.left<(window.innerWidth||document.documentElement.clientWidth)&&t.top<(window.innerHeight||document.documentElement.clientHeight)}},{key:"update",value:function(){var e=this.scrollCalc(),t=i(e,2);this.xPos=t[0],this.yPos=t[1],this.elementInViewport=this.elementsInViewport()}},{key:"elementsInViewport",value:function(){var e=this;return this.viewportChecks.some(function(t){return e.inBounds(t)})}}]),e}();e.exports=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(8),s=function(){function e(){i(this,e),this.is_visible=!0}return r(e,[{key:"update",value:function(){this.is_visible=window.document[o.Adapters.vhidden]}}]),e}();e.exports=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(9),o=i(r),s=n(10),u=i(s);e.exports={$$:o["default"],Adapters:u["default"]}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){n(this,e)}return i(e,null,[{key:"extend",value:function(e,t){return Object.assign(Object.create(Object.prototype),e,t)}}]),e}();e.exports=r},function(e,t){"use strict";var n=void 0,i=void 0;"undefined"!=typeof document.hidden?(n="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(n="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(n="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(n="webkitHidden",i="webkitvisibilitychange"),e.exports={vhidden:n,vchange:i}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){n(this,e),this.session_id=this.sessionId(),this.referrer=this.referrer(),this.source_url=document.URL.replace(/\/$/,"")}return i(e,[{key:"sessionId",value:function t(){var t=window.sessionStorage.getItem("__engage_session");if(null==t){var e=this.idTemplate();return window.sessionStorage.setItem("__engage_session",e),e}return t}},{key:"referrer",value:function(){var e=document.referrer.replace(/\/$/,"");return e.match(location.hostname)?e:""}},{key:"idTemplate",value:function(){return"_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()}}]),e}();e.exports=r}]);
//# sourceMappingURL=engage.min.js.map